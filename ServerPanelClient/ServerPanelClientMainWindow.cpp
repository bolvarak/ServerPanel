///////////////////////////////////////////////////////////////////////////////
/// Headers //////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////

#include <ServerPanelClientMainWindow.h>
#include <ui_ServerPanelClientMainWindow.h>

///////////////////////////////////////////////////////////////////////////////
/// Globals //////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////

ServerPanelClientMainWindow* ServerPanelClientMainWindow::mInstance = NULL;

///////////////////////////////////////////////////////////////////////////////
/// Singleton ////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////

ServerPanelClientMainWindow* ServerPanelClientMainWindow::Instance(QWidget* cParent) {
    // Check for an existing instance
    if (!mInstance) {
        // Create a new instance
        mInstance = new ServerPanelClientMainWindow(cParent);
    }
    // Return the instance
    return mInstance;
}

///////////////////////////////////////////////////////////////////////////////
/// Constructor //////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////

ServerPanelClientMainWindow::ServerPanelClientMainWindow(QWidget* cParent) : QMainWindow(cParent), mUserInterface(new Ui::ServerPanelClientMainWindow) {
    // Setup the user interface instance
    this->mUserInterface->setupUi(this);
    // Set the default display settings
    this->mUserInterface->btnAccountSettings->setText(ServerPanel::Instance()->GetAccount().getProperty("sUsername").toString());
    // Setup the connectors
    this->connect(this->mUserInterface->btnSignOut, SIGNAL(clicked()), this, SLOT(SignOutButtonClicked()));
}

///////////////////////////////////////////////////////////////////////////////
/// Destructor ///////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////

ServerPanelClientMainWindow::~ServerPanelClientMainWindow() {
    // Delete the user interface
    delete this->mUserInterface;
    // Delete the instance
    delete this->mInstance;
}

///////////////////////////////////////////////////////////////////////////////
/// Protected Slots //////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////

/**
 * @paragraph This handles the logout routine
 * @brief ServerPanelClientMainWindow::SignOutButtonClicked
 * @param QString sLink
 * @return void
 */
void ServerPanelClientMainWindow::SignOutButtonClicked() {
    // Close this window
    this->close();
    // Show the login screen
    ServerPanelClientLoginWindow::Instance()->show();
}
